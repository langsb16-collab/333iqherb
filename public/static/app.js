// Translations
const translations = {
  ko: {
    subtitle: 'í”„ë¡œì íŠ¸ê°€ ìë³¸ì„ ë§Œë‚˜ëŠ” ê³³',
    hero_title: 'Code your vision,<br>build your future',
    hero_desc: 'ê°œë°œì, ì „ëµì  íˆ¬ìì ì¡°ë‹¬ í—ˆë¸Œ',
    type_investment: 'íˆ¬ì',
    type_revenue: 'ìˆ˜ìµë¶„ë°°',
    type_startup: 'ì°½ì—…',
    loading: 'í”„ë¡œì íŠ¸ë¥¼ ë¶ˆëŸ¬ì˜¤ëŠ” ì¤‘...',
    no_projects: 'ë“±ë¡ëœ í”„ë¡œì íŠ¸ê°€ ì—†ìŠµë‹ˆë‹¤',
    footer_title: 'í”„ë¡œì íŠ¸ê°€ ìë³¸ì„ ë§Œë‚˜ëŠ” ê³³',
    video_label: 'ì˜ìƒ ë³´ê¸°',
    detail_title: 'í”„ë¡œì íŠ¸ ìƒì„¸ ì •ë³´',
    admin_title: 'ê´€ë¦¬ì í˜ì´ì§€',
    admin_home: 'ë©”ì¸',
    new_project: 'ìƒˆ í”„ë¡œì íŠ¸',
    registered_projects: 'ë“±ë¡ëœ í”„ë¡œì íŠ¸',
    project_name: 'í”„ë¡œì íŠ¸ëª…',
    description: 'í•œì¤„ ì†Œê°œ',
    category: 'ì¹´í…Œê³ ë¦¬',
    funding_type: 'ìê¸ˆ ë°©ì‹',
    amount: 'í¬ë§ ê¸ˆì•¡ (USD $)',
    youtube_links: 'ìœ íŠœë¸Œ ë§í¬ (ìµœëŒ€ 5ê°œ)',
    youtube_link: 'ìœ íŠœë¸Œ ë§í¬',
    text_info: 'í…ìŠ¤íŠ¸ ì •ë³´',
    cancel: 'ì·¨ì†Œ',
    save: 'ì €ì¥',
    edit: 'ìˆ˜ì •',
    delete: 'ì‚­ì œ',
    confirm_delete: 'ì‚­ì œí•˜ì‹œê² ìŠµë‹ˆê¹Œ?',
    success_added: 'âœ… ì¶”ê°€ë˜ì—ˆìŠµë‹ˆë‹¤',
    success_updated: 'âœ… ìˆ˜ì •ë˜ì—ˆìŠµë‹ˆë‹¤',
    success_deleted: 'ì‚­ì œë˜ì—ˆìŠµë‹ˆë‹¤',
    error_save: 'âŒ ì €ì¥ ì˜¤ë¥˜: ',
    error_delete: 'ì‚­ì œ ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤',
    select: 'ì„ íƒ',
    category_medical: 'ì˜ë£Œ',
    category_investment: 'íˆ¬ì',
    category_etc: 'ê¸°íƒ€',
    click_to_play: 'í´ë¦­í•˜ì—¬ ì¬ìƒ'
  },
  en: {
    subtitle: 'Where Projects Meet Capital',
    hero_title: 'Code your vision,<br>build your future',
    hero_desc: 'Developer & Strategic Investor Hub',
    type_investment: 'Investment',
    type_revenue: 'Revenue Share',
    type_startup: 'Startup',
    loading: 'Loading projects...',
    no_projects: 'No projects registered',
    footer_title: 'Where Projects Meet Capital',
    video_label: 'Watch Video',
    detail_title: 'Project Details',
    admin_title: 'Admin Panel',
    admin_home: 'Home',
    new_project: 'New Project',
    registered_projects: 'Registered Projects',
    project_name: 'Project Name',
    description: 'Description',
    category: 'Category',
    funding_type: 'Funding Type',
    amount: 'Target Amount (USD $)',
    youtube_links: 'YouTube Links (Max 5)',
    youtube_link: 'YouTube Link',
    text_info: 'Detailed Info',
    cancel: 'Cancel',
    save: 'Save',
    edit: 'Edit',
    delete: 'Delete',
    confirm_delete: 'Are you sure you want to delete?',
    success_added: 'âœ… Added successfully',
    success_updated: 'âœ… Updated successfully',
    success_deleted: 'Deleted successfully',
    error_save: 'âŒ Save error: ',
    error_delete: 'Error occurred while deleting',
    select: 'Select',
    category_medical: 'Medical',
    category_investment: 'Investment',
    category_etc: 'Other',
    click_to_play: 'Click to Play'
  },
  zh: {
    subtitle: 'é¡¹ç›®ä¸èµ„æœ¬ç›¸é‡ä¹‹åœ°',
    hero_title: 'Code your vision,<br>build your future',
    hero_desc: 'å¼€å‘è€…ä¸æˆ˜ç•¥æŠ•èµ„è€…æ¢çº½',
    type_investment: 'æŠ•èµ„',
    type_revenue: 'æ”¶ç›Šåˆ†é…',
    type_startup: 'åˆ›ä¸š',
    loading: 'æ­£åœ¨åŠ è½½é¡¹ç›®...',
    no_projects: 'æ²¡æœ‰æ³¨å†Œçš„é¡¹ç›®',
    footer_title: 'é¡¹ç›®ä¸èµ„æœ¬ç›¸é‡ä¹‹åœ°',
    video_label: 'è§‚çœ‹è§†é¢‘',
    detail_title: 'é¡¹ç›®è¯¦æƒ…',
    admin_title: 'ç®¡ç†å‘˜é¡µé¢',
    admin_home: 'ä¸»é¡µ',
    new_project: 'æ–°é¡¹ç›®',
    registered_projects: 'å·²æ³¨å†Œé¡¹ç›®',
    project_name: 'é¡¹ç›®åç§°',
    description: 'ç®€ä»‹',
    category: 'ç±»åˆ«',
    funding_type: 'èµ„é‡‘æ–¹å¼',
    amount: 'ç›®æ ‡é‡‘é¢ï¼ˆç¾å…ƒ $ï¼‰',
    youtube_links: 'YouTubeé“¾æ¥ï¼ˆæœ€å¤š5ä¸ªï¼‰',
    youtube_link: 'YouTubeé“¾æ¥',
    text_info: 'è¯¦ç»†ä¿¡æ¯',
    cancel: 'å–æ¶ˆ',
    save: 'ä¿å­˜',
    edit: 'ç¼–è¾‘',
    delete: 'åˆ é™¤',
    confirm_delete: 'ç¡®å®šè¦åˆ é™¤å—ï¼Ÿ',
    success_added: 'âœ… æ·»åŠ æˆåŠŸ',
    success_updated: 'âœ… ä¿®æ”¹æˆåŠŸ',
    success_deleted: 'åˆ é™¤æˆåŠŸ',
    error_save: 'âŒ ä¿å­˜é”™è¯¯ï¼š',
    error_delete: 'åˆ é™¤æ—¶å‘ç”Ÿé”™è¯¯',
    select: 'é€‰æ‹©',
    category_medical: 'åŒ»ç–—',
    category_investment: 'æŠ•èµ„',
    category_etc: 'å…¶ä»–',
    click_to_play: 'ç‚¹å‡»æ’­æ”¾'
  }
};

let currentLang = localStorage.getItem('lang') || 'ko';
let projects = [];
let editing = null;

function changeLang(lang) {
  currentLang = lang;
  localStorage.setItem('lang', lang);
  
  // Update language buttons
  document.querySelectorAll('.lang-btn').forEach(btn => {
    btn.classList.remove('active');
    if (btn.dataset.lang === lang) {
      btn.classList.add('active');
    }
  });
  
  // Update all translated elements
  document.querySelectorAll('[data-i18n]').forEach(el => {
    const key = el.dataset.i18n;
    if (translations[lang][key]) {
      el.innerHTML = translations[lang][key];
    }
  });
  
  // Reload projects with new language
  loadProjects();
}

function t(key) {
  return translations[currentLang][key] || translations['ko'][key] || key;
}

function translateFundingType(type) {
  const fundingMap = {
    'investment': { 'ko': 'íˆ¬ì', 'en': 'Investment', 'zh': 'æŠ•èµ„' },
    'donation': { 'ko': 'ìˆ˜ìµë¶„ë°°', 'en': 'Revenue Share', 'zh': 'æ”¶ç›Šåˆ†é…' }
  };
  
  // Find matching type
  for (const key of Object.keys(fundingMap)) {
    const values = Object.values(fundingMap[key]);
    if (values.includes(type)) {
      return fundingMap[key][currentLang];
    }
  }
  
  return type;
}

function translateCategory(category) {
  const categoryMap = {
    'ko': { 'ì˜ë£Œ': 'ì˜ë£Œ', 'íˆ¬ì': 'íˆ¬ì', 'ê¸°íƒ€': 'ê¸°íƒ€' },
    'en': { 'ì˜ë£Œ': 'Medical', 'íˆ¬ì': 'Investment', 'ê¸°íƒ€': 'Other' },
    'zh': { 'ì˜ë£Œ': 'åŒ»ç–—', 'íˆ¬ì': 'æŠ•èµ„', 'ê¸°íƒ€': 'å…¶ä»–' }
  };
  
  for (const ko of Object.keys(categoryMap['ko'])) {
    if (category === ko || category === categoryMap['en'][ko] || category === categoryMap['zh'][ko]) {
      return categoryMap[currentLang][ko];
    }
  }
  
  return category;
}

function getTranslatedField(project, field) {
  const langField = `${field}_${currentLang}`;
  if (project[langField]) {
    return project[langField];
  }
  
  const baseValue = project[field] || '';
  if (baseValue.includes('|||')) {
    const parts = baseValue.split('|||').map(s => s.trim());
    if (currentLang === 'ko') return parts[0] || baseValue;
    if (currentLang === 'en') return parts[1] || parts[0] || baseValue;
    if (currentLang === 'zh') return parts[2] || parts[0] || baseValue;
  }
  
  return baseValue;
}

// Initialize language on load
document.addEventListener('DOMContentLoaded', () => {
  changeLang(currentLang);
});

// Load projects from API
async function loadProjects() {
  const container = document.getElementById('projectsContainer');
  const loading = document.getElementById('loadingIndicator');
  const empty = document.getElementById('emptyState');

  try {
    const response = await axios.get('/api/projects');
    projects = response.data.data || [];
    
    loading.style.display = 'none';
    
    if (projects.length === 0) {
      empty.classList.remove('hidden');
      return;
    }

    container.innerHTML = projects.map(project => {
      const title = getTranslatedField(project, 'title');
      const description = getTranslatedField(project, 'description');
      const category = translateCategory(project.category || 'ê¸°íƒ€');
      const fundingType = project.funding_type || 'investment';
      
      // Determine badge class and text based on funding type and language
      let badgeClass = 'badge-investment';
      let badgeIcon = 'ğŸ”»';
      let badgeText = '';
      
      if (fundingType === 'investment' || fundingType.includes('íˆ¬ì') || fundingType.includes('Investment')) {
        if (currentLang === 'ko') {
          badgeClass = 'badge-investment';
          badgeText = 'íˆ¬ì';
        } else if (currentLang === 'en') {
          badgeClass = 'badge-orange';
          badgeText = 'Investment';
        } else {
          badgeClass = 'badge-orange';
          badgeText = t('type_investment');
        }
      } else if (fundingType === 'donation' || fundingType.includes('ìˆ˜ìµ') || fundingType.includes('Revenue')) {
        badgeClass = 'badge-donation';
        badgeText = t('type_revenue');
      }
      
      return `
      <div class="project-card" onclick="showProjectDetail('${project.id}')">
        <div class="project-card-header">
          <span class="category-label">${category}</span>
        </div>
        <div class="project-card-body">
          <h3 class="project-title">${title}</h3>
          <p class="project-description">${description || ''}</p>
        </div>
        <div class="project-card-footer">
          <span class="badge ${badgeClass}">${badgeIcon} ${badgeText}</span>
          <span class="amount-badge">$ ${(project.amount || 0).toLocaleString()}</span>
        </div>
      </div>
    `;
    }).join('');
  } catch (error) {
    console.error('Error loading projects:', error);
    loading.style.display = 'none';
    empty.classList.remove('hidden');
  }
}

function getYouTubeVideoId(url) {
  if (!url) return null;
  const patterns = [
    /(?:youtube\.com\/watch\?v=|youtu\.be\/)([^&\s?]+)/,
    /youtube\.com\/embed\/([^&\s?]+)/,
    /youtube\.com\/v\/([^&\s?]+)/,
    /youtube\.com\/shorts\/([^&\s?]+)/
  ];
  for (const pattern of patterns) {
    const match = url.match(pattern);
    if (match && match[1]) return match[1].substring(0, 11);
  }
  return null;
}

function showProjectDetail(id) {
  const project = projects.find(p => p.id == id);
  if (!project) return;
  
  // Get all YouTube URLs
  const youtubeUrls = [
    project.youtube_url_1,
    project.youtube_url_2,
    project.youtube_url_3,
    project.youtube_url_4,
    project.youtube_url_5
  ].filter(url => url && url.trim()).map(url => getYouTubeVideoId(url)).filter(id => id);
  
  const title = getTranslatedField(project, 'title');
  const description = getTranslatedField(project, 'description');
  const textInfo = getTranslatedField(project, 'text_info');
  const fundingType = translateFundingType(project.funding_type);
  
  const modal = document.createElement('div');
  modal.className = 'fixed inset-0 bg-black bg-opacity-50 z-50 flex items-center justify-center p-4';
  modal.onclick = (e) => { if (e.target === modal) modal.remove(); };
  
  // Videos section HTML - vertical layout for 2-5 videos
  let videosHTML = '';
  if (youtubeUrls.length > 0) {
    videosHTML = `
      <div class="bg-gray-50 rounded-lg p-4 mb-4">
        <h3 class="text-lg font-bold mb-3 text-center">
          <i class="fab fa-youtube text-red-600 mr-2"></i>${t('video_label')} (${youtubeUrls.length}ê°œ)
        </h3>
        <div class="space-y-4 max-w-3xl mx-auto">
          ${youtubeUrls.map((videoId, index) => `
            <div class="youtube-thumbnail" id="modal-video-${index}" onclick="playVideo('modal-video-${index}', '${videoId}')">
              <img src="https://img.youtube.com/vi/${videoId}/hqdefault.jpg" alt="Video ${index + 1}">
              <div class="play-button"></div>
              <div class="absolute bottom-2 right-2 bg-black bg-opacity-75 text-white text-xs px-2 py-1 rounded">
                ${t('click_to_play')}
              </div>
            </div>
          `).join('')}
        </div>
      </div>
    `;
  }
  
  modal.innerHTML = `
    <div class="bg-white rounded-lg max-w-4xl w-full max-h-[90vh] overflow-y-auto" onclick="event.stopPropagation()">
      <div class="p-6">
        <div class="flex justify-between items-start mb-4">
          <h2 class="text-2xl font-bold text-gray-900">${title}</h2>
          <button onclick="this.closest('.fixed').remove()" class="text-gray-500 hover:text-gray-700">
            <i class="fas fa-times text-2xl"></i>
          </button>
        </div>
        
        <div class="mb-4">
          <p class="text-gray-700 mb-2">${description}</p>
          ${textInfo ? `<p class="text-gray-600 text-sm">${textInfo}</p>` : ''}
        </div>
        
        <div class="flex gap-2 mb-4">
          <span class="inline-block px-3 py-1 rounded-full text-sm font-semibold bg-blue-100 text-blue-800">
            ${fundingType}
          </span>
          <span class="inline-block px-3 py-1 rounded-full text-sm font-semibold bg-green-100 text-green-800">
            $${(project.amount || 0).toLocaleString()}
          </span>
        </div>
        
        ${videosHTML}
      </div>
    </div>
  `;
  
  document.body.appendChild(modal);
}

function playVideo(elementId, videoId) {
  const element = document.getElementById(elementId);
  if (!element) return;
  
  element.innerHTML = `
    <iframe 
      width="100%" 
      height="100%" 
      src="https://www.youtube.com/embed/${videoId}?autoplay=1" 
      frameborder="0" 
      allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" 
      allowfullscreen
      style="position: absolute; top: 0; left: 0; width: 100%; height: 100%;"
    ></iframe>
  `;
}

// Admin page functions
async function loadAdminProjects() {
  try {
    const response = await axios.get('/api/projects');
    projects = response.data.data || [];
    
    const container = document.getElementById('adminProjectsList');
    container.innerHTML = projects.map(project => {
      const title = project.title_ko || project.title || 'No Title';
      return `
      <div class="bg-white rounded-lg shadow p-4 flex justify-between items-center">
        <div class="flex-1">
          <h3 class="font-bold text-gray-900">${title}</h3>
          <p class="text-sm text-gray-600">${project.category || ''} | ${project.funding_type || ''} | $${(project.amount || 0).toLocaleString()}</p>
        </div>
        <div class="flex gap-2">
          <button onclick="editProject(${project.id})" class="text-blue-600 hover:text-blue-800">
            <i class="fas fa-edit"></i>
          </button>
          <button onclick="deleteProject(${project.id})" class="text-red-600 hover:text-red-800">
            <i class="fas fa-trash"></i>
          </button>
        </div>
      </div>
    `;
    }).join('');
  } catch (error) {
    console.error('Error loading admin projects:', error);
  }
}

function showProjectForm(projectId = null) {
  editing = projectId ? projects.find(p => p.id == projectId) : null;
  
  const modal = document.createElement('div');
  modal.className = 'fixed inset-0 bg-black bg-opacity-50 z-50 flex items-center justify-center p-4';
  modal.onclick = (e) => { if (e.target === modal) modal.remove(); };
  
  modal.innerHTML = `
    <div class="bg-white rounded-lg max-w-2xl w-full max-h-[90vh] overflow-y-auto p-6" onclick="event.stopPropagation()">
      <h2 class="text-2xl font-bold mb-4">${editing ? t('edit') : t('new_project')}</h2>
      
      <form id="projectForm" class="space-y-4">
        <div>
          <label class="block text-sm font-medium mb-1">${t('project_name')} (${t('select')} í•œêµ­ì–´|||English|||ä¸­æ–‡)</label>
          <textarea id="projectTitle" class="w-full border rounded px-3 py-2" rows="2" required
            placeholder="ì˜ˆ: í˜ì‹ ì ì¸ ëª¨ë°”ì¼ ì•±|||Innovative mobile app|||åˆ›æ–°ç§»åŠ¨åº”ç”¨">${editing ? (editing.title_ko || editing.title || '') : ''}</textarea>
        </div>
        
        <div>
          <label class="block text-sm font-medium mb-1">${t('description')} (í•œêµ­ì–´|||English|||ä¸­æ–‡)</label>
          <textarea id="projectDescription" class="w-full border rounded px-3 py-2" rows="3"
            placeholder="ì˜ˆ: ìµœì‹  ê¸°ìˆ  ê¸°ë°˜|||Based on latest tech|||åŸºäºæœ€æ–°æŠ€æœ¯">${editing ? (editing.description_ko || editing.description || '') : ''}</textarea>
        </div>
        
        <div class="grid grid-cols-2 gap-4">
          <div>
            <label class="block text-sm font-medium mb-1">${t('category')}</label>
            <select id="projectCategory" class="w-full border rounded px-3 py-2">
              <option value="ì˜ë£Œ" ${editing && editing.category === 'ì˜ë£Œ' ? 'selected' : ''}>ì˜ë£Œ</option>
              <option value="íˆ¬ì" ${editing && editing.category === 'íˆ¬ì' ? 'selected' : ''}>íˆ¬ì</option>
              <option value="ê¸°íƒ€" ${editing && editing.category === 'ê¸°íƒ€' ? 'selected' : ''}>ê¸°íƒ€</option>
            </select>
          </div>
          
          <div>
            <label class="block text-sm font-medium mb-1">${t('funding_type')}</label>
            <select id="projectFundingType" class="w-full border rounded px-3 py-2">
              <option value="investment" ${editing && editing.funding_type === 'investment' ? 'selected' : ''}>íˆ¬ì</option>
              <option value="donation" ${editing && editing.funding_type === 'donation' ? 'selected' : ''}>ìˆ˜ìµë¶„ë°°</option>
            </select>
          </div>
        </div>
        
        <div>
          <label class="block text-sm font-medium mb-1">${t('amount')}</label>
          <input type="number" id="projectAmount" class="w-full border rounded px-3 py-2" min="0" step="1000"
            value="${editing ? editing.amount || 0 : 0}">
        </div>
        
        <div>
          <label class="block text-sm font-medium mb-2">${t('youtube_links')}</label>
          <div class="space-y-2">
            ${[1, 2, 3, 4, 5].map(i => `
              <input type="url" id="youtubeUrl${i}" class="w-full border rounded px-3 py-2" 
                placeholder="${t('youtube_link')} ${i}"
                value="${editing ? editing[`youtube_url_${i}`] || '' : ''}">
            `).join('')}
          </div>
        </div>
        
        <div>
          <label class="block text-sm font-medium mb-1">${t('text_info')} (í•œêµ­ì–´|||English|||ä¸­æ–‡)</label>
          <textarea id="projectTextInfo" class="w-full border rounded px-3 py-2" rows="2"
            placeholder="ì˜ˆ: ì¶”ê°€ ì •ë³´|||Additional info|||é™„åŠ ä¿¡æ¯">${editing ? (editing.text_info_ko || editing.text_info || '') : ''}</textarea>
        </div>
        
        <div class="flex gap-2 justify-end">
          <button type="button" onclick="this.closest('.fixed').remove()" 
            class="px-4 py-2 border rounded hover:bg-gray-100">${t('cancel')}</button>
          <button type="submit" class="px-4 py-2 bg-blue-600 text-white rounded hover:bg-blue-700">${t('save')}</button>
        </div>
      </form>
    </div>
  `;
  
  document.body.appendChild(modal);
  
  document.getElementById('projectForm').onsubmit = async (e) => {
    e.preventDefault();
    await saveProject();
    modal.remove();
  };
}

async function saveProject() {
  const title = document.getElementById('projectTitle').value.trim();
  const description = document.getElementById('projectDescription').value.trim();
  const category = document.getElementById('projectCategory').value;
  const fundingType = document.getElementById('projectFundingType').value;
  const amount = parseInt(document.getElementById('projectAmount').value) || 0;
  const textInfo = document.getElementById('projectTextInfo').value.trim();
  
  // Parse multilingual fields
  const [title_ko, title_en, title_zh] = title.includes('|||') ? title.split('|||').map(s => s.trim()) : [title, title, title];
  const [desc_ko, desc_en, desc_zh] = description.includes('|||') ? description.split('|||').map(s => s.trim()) : [description, description, description];
  const [text_ko, text_en, text_zh] = textInfo.includes('|||') ? textInfo.split('|||').map(s => s.trim()) : [textInfo, textInfo, textInfo];
  
  const data = {
    title: title_ko,
    title_ko, title_en, title_zh,
    description: desc_ko,
    description_ko: desc_ko, description_en: desc_en, description_zh: desc_zh,
    category,
    funding_type: fundingType,
    amount,
    youtube_url_1: document.getElementById('youtubeUrl1').value.trim(),
    youtube_url_2: document.getElementById('youtubeUrl2').value.trim(),
    youtube_url_3: document.getElementById('youtubeUrl3').value.trim(),
    youtube_url_4: document.getElementById('youtubeUrl4').value.trim(),
    youtube_url_5: document.getElementById('youtubeUrl5').value.trim(),
    text_info: text_ko,
    text_info_ko: text_ko, text_info_en: text_en, text_info_zh: text_zh
  };
  
  try {
    if (editing) {
      await axios.put(`/api/projects/${editing.id}`, data);
      alert(t('success_updated'));
    } else {
      await axios.post('/api/projects', data);
      alert(t('success_added'));
    }
    loadAdminProjects();
  } catch (error) {
    console.error('Error saving project:', error);
    alert(t('error_save') + (error.response?.data?.message || error.message));
  }
}

function editProject(id) {
  showProjectForm(id);
}

async function deleteProject(id) {
  if (!confirm(t('confirm_delete'))) return;
  
  try {
    await axios.delete(`/api/projects/${id}`);
    alert(t('success_deleted'));
    loadAdminProjects();
  } catch (error) {
    console.error('Error deleting project:', error);
    alert(t('error_delete'));
  }
}

// Router for SPA
function loadPage() {
  const hash = window.location.hash.slice(1) || '/';
  const mainPage = document.getElementById('mainPage');
  const adminPage = document.getElementById('adminPage');
  
  if (hash === '/admin') {
    mainPage.style.display = 'none';
    adminPage.style.display = 'block';
    loadAdminProjects();
  } else {
    mainPage.style.display = 'block';
    adminPage.style.display = 'none';
    loadProjects();
  }
}

window.addEventListener('hashchange', loadPage);
window.addEventListener('load', loadPage);
